/*
 * Custom scripts library
 *
 * @version 1.0.6
 */
	
function checkMobileNavgation(nav) {
	var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
	if (!nav.hasClass('burger'))
		if ( width < 768 ) nav.addClass('mobile')
		else nav.removeClass('mobile')
}

document.addEventListener('readystatechange', function(el) {
	if ( document.readyState === 'interactive' ) {
		// Adding class after full DOM loading for applying CSS animation
		//$('#main-header').addClass('visible');
		$.when( $('#dom-preloader').find('i').removeClass('fa-spin').end().delay(500).fadeOut('slow') )
		.done( function() { 
			$('body').fadeIn();
			$('#dom-preloader').remove(); 
		});		
	}
});

document.addEventListener("DOMContentLoaded", function() {

	var navigation = $('#header-nav');
	checkMobileNavgation(navigation);
	navigation.css('opacity', 1);
	var burger = $('#nav-burger');
	var mainheader = $('#main-header');
	var scrollup = $('#scroll-up');
	var search = $('#site-search-modal');
	var back2top = $('#back-to-top');

/*
// inView.js
	inView('.someSelector')
		.on('enter', el => {
			el.style.opacity =1;
			el.classList.add('visible');
		})
		.on('exit', el => {
			el.style.opacity = 0.5;
		});	
*/

	$( window ).on( 'resize', function( e ) {
		checkMobileNavgation(navigation);
		if (burger.hasClass('active')) burger.click(); // if burger menu open then close it 
	});

	$(window).scroll(function() {
		//addVisibleClass(document.body.querySelectorAll('article')); //viewport.js

		$('#back-to-top').topBtnToggle({
			scrollTrigger: 1200,
			//debug: true,
		});

		if ( $('body').has('.parallax').length ) {
			// init parallax for background
			$('.parallax').bgParallax({
				bgpositionY: 50, //it must be the same background-position value in css 
				speed: 0.5,
			});
		}
	});

/*
// Click event on link starting from # for landing page
	$('a[href^="#"]').on('click', function (e) {
		e.preventDefault();
		var target = $(this).attr('href');
		if ( target.length > 1 && window.location.pathname == '/' && window.location.search == '') { //if home page and no search query and no only #
			//if ($(target).hasClass('animate')) $(target).removeClass('animate');
			if (burger.is(':visible')) burger.click(); //close burger menu on link clicking

			var top = $(target).offset().top;
			$('html, body').animate({scrollTop: top}, 500+top/4); //800 - длительность скроллинга в мс			
		} else {
			//target = target.replace(/[^A-Za-z]/g, "");
			location.replace('/'+target);
		}
	});

*/	burger.on('click', function (e) {
		if (burger.is(':visible')) {
			burger.toggleClass('active');
			$('#menu-top').toggleClass('active');
			$(document.body).toggleClass('modal');
		}
	});

	var submenu_item = $('.menu-item-has-children a').on('click', function (e) {
		e.preventDefault();
		$(this).parent().toggleClass('collapsed');
	});
		
	$( document ).on( 'keyup', function (e) {
		e.preventDefault();
		if( e.keyCode == 27 && search.is(':visible') )
			search.fadeToggle(300) //close search form
		else
		if( e.keyCode == 27 && burger.hasClass('active') ) burger.click(); // close burger menu on esc key
	});
	
	scrollup.on('click', function (e) {
		var mc = document.body.querySelector('#main-container');
		scrollup
		.fadeOut('slow')
		.delay(500)
		.remove()
		.delay(500)
		.queue( function() {
			mc.scrollIntoView({block: "start", behavior: "smooth"});
		});
	});

	back2top.on('click', function (e) {		
		// 800 - скорость задержки перемещения наверх (в миллисекундах)
		e.preventDefault();
		$('html,body').animate({scrollTop: 0}, 800);		
	});

	$('#nav-search').on('click', function (e) {
		if ( !search.attr('display','none') && search.find('#s').val() ) {
			$('#searchform').submit(); 
		} else search.fadeToggle(300);
	});

	$('#searchform').on('submit', function (e) {
		//идет поиск...
		//можно вывести preloader с надписью
	});

	$('#searchform-close').on('click', function (e) {
		var field_s = search.find('#s');
		if ( field_s.val() ) field_s.val('')
		else search.fadeToggle(300);
	});

	if ( $('.jcarousel').length > 0 ) {
		var j = $(".jcarousel-wrapper li");
		if (j.length > 0) j.css("width", j.parents(".jcarousel-wrapper").css("width"));
	}
	
	if ( $('.jcarousel').has('.header-background').length ) {

		$('[data-jcarousel]').each(function() {
			var el = $(this);
			el.jcarousel(el.data());
		});

		$('.jcarousel')		
			.on('jcarousel:reloadend', function(event, carousel) {
				$(this).jcarousel('target').addClass('active');

			})
			.on('jcarousel:visibleout', 'li', function() {
				$(this).removeClass('active');
			})
			.on('jcarousel:visiblein', 'li', function() {
				$(this).addClass('active');
			})
			.jcarousel({
				wrap: 'circular',
				animation: 1000,
				transitions: Modernizr.csstransitions ? {
					transforms:   Modernizr.csstransforms,
					transforms3d: Modernizr.csstransforms3d,
					easing:       'ease'
				} : false
			})
			.jcarouselSwipe();

			if ( 'true' === $('.jcarousel').attr('data-jcarouselautoscroll') ) {
				$('.jcarousel').jcarouselAutoscroll({
					interval:  5000,
					//autostart: false,
					//target: '-=1',
				});
			}

			if ( $('.jcarousel-wrapper').has('.jcarousel-control').length ) {
			
			$('.jcarousel-control.prev')
				.on('jcarouselcontrol:active', function() {
					$(this).removeClass('inactive');
				})
				.on('jcarouselcontrol:inactive', function() {
					$(this).addClass('inactive');
				})
				.jcarouselControl({
					target: '-=1'
				});

			$('.jcarousel-control.next')
				.on('jcarouselcontrol:active', function() {
					$(this).removeClass('inactive');
				})
				.on('jcarouselcontrol:inactive', function() {
					$(this).addClass('inactive');
				})
				.jcarouselControl({
					target: '+=1'
				});

			$(".jcarousel-wrapper").hover( function() {
				$('.jcarousel-control').fadeIn(700);
			}, function() {
				$('.jcarousel-control').fadeOut(700);
			});

		}

		if ( $('.jcarousel-wrapper').has('.jcarousel-pagination').length && 'true' === $('.jcarousel-pagination').attr('data-jcarouselpagination') ) {
			$('.jcarousel-pagination')
				.on('jcarouselpagination:active', 'a', function() {
					$(this).addClass('active');
				})
				.on('jcarouselpagination:inactive', 'a', function() {
					$(this).removeClass('active');
				})
				.jcarouselPagination();
		} else $('.jcarousel-pagination').remove();
	}

	//Adding an agent to HTML selector
	var deviceAgent = navigator.userAgent.toLowerCase();
	if (deviceAgent.match(/(iphone|ipod|ipad)/)) {
		$("html").addClass("ios");
		$("html").addClass("mobile");
	}
	if (navigator.userAgent.search("MSIE") >= 0) {
		$("html").addClass("ie");
	}
	else if (navigator.userAgent.search("Chrome") >= 0) {
		$("html").addClass("chrome");
	}
	else if (navigator.userAgent.search("Firefox") >= 0) {
		$("html").addClass("firefox");
	}
	else if (navigator.userAgent.search("Safari") >= 0 && navigator.userAgent.search("Chrome") < 0) {
		$("html").addClass("safari");
	}
	else if (navigator.userAgent.search("Opera") >= 0) {
		$("html").addClass("opera");
	}

});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJjdXN0b20ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ3VzdG9tIHNjcmlwdHMgbGlicmFyeVxyXG4gKlxyXG4gKiBAdmVyc2lvbiAxLjAuNlxyXG4gKi9cclxuXHRcclxuZnVuY3Rpb24gY2hlY2tNb2JpbGVOYXZnYXRpb24obmF2KSB7XHJcblx0dmFyIHdpZHRoID0gd2luZG93LmlubmVyV2lkdGggfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIHx8IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7XHJcblx0aWYgKCFuYXYuaGFzQ2xhc3MoJ2J1cmdlcicpKVxyXG5cdFx0aWYgKCB3aWR0aCA8IDc2OCApIG5hdi5hZGRDbGFzcygnbW9iaWxlJylcclxuXHRcdGVsc2UgbmF2LnJlbW92ZUNsYXNzKCdtb2JpbGUnKVxyXG59XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdyZWFkeXN0YXRlY2hhbmdlJywgZnVuY3Rpb24oZWwpIHtcclxuXHRpZiAoIGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdpbnRlcmFjdGl2ZScgKSB7XHJcblx0XHQvLyBBZGRpbmcgY2xhc3MgYWZ0ZXIgZnVsbCBET00gbG9hZGluZyBmb3IgYXBwbHlpbmcgQ1NTIGFuaW1hdGlvblxyXG5cdFx0Ly8kKCcjbWFpbi1oZWFkZXInKS5hZGRDbGFzcygndmlzaWJsZScpO1xyXG5cdFx0JC53aGVuKCAkKCcjZG9tLXByZWxvYWRlcicpLmZpbmQoJ2knKS5yZW1vdmVDbGFzcygnZmEtc3BpbicpLmVuZCgpLmRlbGF5KDUwMCkuZmFkZU91dCgnc2xvdycpIClcclxuXHRcdC5kb25lKCBmdW5jdGlvbigpIHsgXHJcblx0XHRcdCQoJ2JvZHknKS5mYWRlSW4oKTtcclxuXHRcdFx0JCgnI2RvbS1wcmVsb2FkZXInKS5yZW1vdmUoKTsgXHJcblx0XHR9KTtcdFx0XHJcblx0fVxyXG59KTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uKCkge1xyXG5cclxuXHR2YXIgbmF2aWdhdGlvbiA9ICQoJyNoZWFkZXItbmF2Jyk7XHJcblx0Y2hlY2tNb2JpbGVOYXZnYXRpb24obmF2aWdhdGlvbik7XHJcblx0bmF2aWdhdGlvbi5jc3MoJ29wYWNpdHknLCAxKTtcclxuXHR2YXIgYnVyZ2VyID0gJCgnI25hdi1idXJnZXInKTtcclxuXHR2YXIgbWFpbmhlYWRlciA9ICQoJyNtYWluLWhlYWRlcicpO1xyXG5cdHZhciBzY3JvbGx1cCA9ICQoJyNzY3JvbGwtdXAnKTtcclxuXHR2YXIgc2VhcmNoID0gJCgnI3NpdGUtc2VhcmNoLW1vZGFsJyk7XHJcblx0dmFyIGJhY2sydG9wID0gJCgnI2JhY2stdG8tdG9wJyk7XHJcblxyXG4vKlxyXG4vLyBpblZpZXcuanNcclxuXHRpblZpZXcoJy5zb21lU2VsZWN0b3InKVxyXG5cdFx0Lm9uKCdlbnRlcicsIGVsID0+IHtcclxuXHRcdFx0ZWwuc3R5bGUub3BhY2l0eSA9MTtcclxuXHRcdFx0ZWwuY2xhc3NMaXN0LmFkZCgndmlzaWJsZScpO1xyXG5cdFx0fSlcclxuXHRcdC5vbignZXhpdCcsIGVsID0+IHtcclxuXHRcdFx0ZWwuc3R5bGUub3BhY2l0eSA9IDAuNTtcclxuXHRcdH0pO1x0XHJcbiovXHJcblxyXG5cdCQoIHdpbmRvdyApLm9uKCAncmVzaXplJywgZnVuY3Rpb24oIGUgKSB7XHJcblx0XHRjaGVja01vYmlsZU5hdmdhdGlvbihuYXZpZ2F0aW9uKTtcclxuXHRcdGlmIChidXJnZXIuaGFzQ2xhc3MoJ2FjdGl2ZScpKSBidXJnZXIuY2xpY2soKTsgLy8gaWYgYnVyZ2VyIG1lbnUgb3BlbiB0aGVuIGNsb3NlIGl0IFxyXG5cdH0pO1xyXG5cclxuXHQkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly9hZGRWaXNpYmxlQ2xhc3MoZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCdhcnRpY2xlJykpOyAvL3ZpZXdwb3J0LmpzXHJcblxyXG5cdFx0JCgnI2JhY2stdG8tdG9wJykudG9wQnRuVG9nZ2xlKHtcclxuXHRcdFx0c2Nyb2xsVHJpZ2dlcjogMTIwMCxcclxuXHRcdFx0Ly9kZWJ1ZzogdHJ1ZSxcclxuXHRcdH0pO1xyXG5cclxuXHRcdGlmICggJCgnYm9keScpLmhhcygnLnBhcmFsbGF4JykubGVuZ3RoICkge1xyXG5cdFx0XHQvLyBpbml0IHBhcmFsbGF4IGZvciBiYWNrZ3JvdW5kXHJcblx0XHRcdCQoJy5wYXJhbGxheCcpLmJnUGFyYWxsYXgoe1xyXG5cdFx0XHRcdGJncG9zaXRpb25ZOiA1MCwgLy9pdCBtdXN0IGJlIHRoZSBzYW1lIGJhY2tncm91bmQtcG9zaXRpb24gdmFsdWUgaW4gY3NzIFxyXG5cdFx0XHRcdHNwZWVkOiAwLjUsXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuLypcclxuLy8gQ2xpY2sgZXZlbnQgb24gbGluayBzdGFydGluZyBmcm9tICMgZm9yIGxhbmRpbmcgcGFnZVxyXG5cdCQoJ2FbaHJlZl49XCIjXCJdJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdHZhciB0YXJnZXQgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKTtcclxuXHRcdGlmICggdGFyZ2V0Lmxlbmd0aCA+IDEgJiYgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09ICcvJyAmJiB3aW5kb3cubG9jYXRpb24uc2VhcmNoID09ICcnKSB7IC8vaWYgaG9tZSBwYWdlIGFuZCBubyBzZWFyY2ggcXVlcnkgYW5kIG5vIG9ubHkgI1xyXG5cdFx0XHQvL2lmICgkKHRhcmdldCkuaGFzQ2xhc3MoJ2FuaW1hdGUnKSkgJCh0YXJnZXQpLnJlbW92ZUNsYXNzKCdhbmltYXRlJyk7XHJcblx0XHRcdGlmIChidXJnZXIuaXMoJzp2aXNpYmxlJykpIGJ1cmdlci5jbGljaygpOyAvL2Nsb3NlIGJ1cmdlciBtZW51IG9uIGxpbmsgY2xpY2tpbmdcclxuXHJcblx0XHRcdHZhciB0b3AgPSAkKHRhcmdldCkub2Zmc2V0KCkudG9wO1xyXG5cdFx0XHQkKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7c2Nyb2xsVG9wOiB0b3B9LCA1MDArdG9wLzQpOyAvLzgwMCAtINC00LvQuNGC0LXQu9GM0L3QvtGB0YLRjCDRgdC60YDQvtC70LvQuNC90LPQsCDQsiDQvNGBXHRcdFx0XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvL3RhcmdldCA9IHRhcmdldC5yZXBsYWNlKC9bXkEtWmEtel0vZywgXCJcIik7XHJcblx0XHRcdGxvY2F0aW9uLnJlcGxhY2UoJy8nK3RhcmdldCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG4qL1x0YnVyZ2VyLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHRpZiAoYnVyZ2VyLmlzKCc6dmlzaWJsZScpKSB7XHJcblx0XHRcdGJ1cmdlci50b2dnbGVDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdCQoJyNtZW51LXRvcCcpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0JChkb2N1bWVudC5ib2R5KS50b2dnbGVDbGFzcygnbW9kYWwnKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0dmFyIHN1Ym1lbnVfaXRlbSA9ICQoJy5tZW51LWl0ZW0taGFzLWNoaWxkcmVuIGEnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0JCh0aGlzKS5wYXJlbnQoKS50b2dnbGVDbGFzcygnY29sbGFwc2VkJyk7XHJcblx0fSk7XHJcblx0XHRcclxuXHQkKCBkb2N1bWVudCApLm9uKCAna2V5dXAnLCBmdW5jdGlvbiAoZSkge1xyXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0aWYoIGUua2V5Q29kZSA9PSAyNyAmJiBzZWFyY2guaXMoJzp2aXNpYmxlJykgKVxyXG5cdFx0XHRzZWFyY2guZmFkZVRvZ2dsZSgzMDApIC8vY2xvc2Ugc2VhcmNoIGZvcm1cclxuXHRcdGVsc2VcclxuXHRcdGlmKCBlLmtleUNvZGUgPT0gMjcgJiYgYnVyZ2VyLmhhc0NsYXNzKCdhY3RpdmUnKSApIGJ1cmdlci5jbGljaygpOyAvLyBjbG9zZSBidXJnZXIgbWVudSBvbiBlc2Mga2V5XHJcblx0fSk7XHJcblx0XHJcblx0c2Nyb2xsdXAub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciBtYyA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignI21haW4tY29udGFpbmVyJyk7XHJcblx0XHRzY3JvbGx1cFxyXG5cdFx0LmZhZGVPdXQoJ3Nsb3cnKVxyXG5cdFx0LmRlbGF5KDUwMClcclxuXHRcdC5yZW1vdmUoKVxyXG5cdFx0LmRlbGF5KDUwMClcclxuXHRcdC5xdWV1ZSggZnVuY3Rpb24oKSB7XHJcblx0XHRcdG1jLnNjcm9sbEludG9WaWV3KHtibG9jazogXCJzdGFydFwiLCBiZWhhdmlvcjogXCJzbW9vdGhcIn0pO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcblxyXG5cdGJhY2sydG9wLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHRcdFxyXG5cdFx0Ly8gODAwIC0g0YHQutC+0YDQvtGB0YLRjCDQt9Cw0LTQtdGA0LbQutC4INC/0LXRgNC10LzQtdGJ0LXQvdC40Y8g0L3QsNCy0LXRgNGFICjQsiDQvNC40LvQu9C40YHQtdC60YPQvdC00LDRhSlcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdCQoJ2h0bWwsYm9keScpLmFuaW1hdGUoe3Njcm9sbFRvcDogMH0sIDgwMCk7XHRcdFxyXG5cdH0pO1xyXG5cclxuXHQkKCcjbmF2LXNlYXJjaCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHRpZiAoICFzZWFyY2guYXR0cignZGlzcGxheScsJ25vbmUnKSAmJiBzZWFyY2guZmluZCgnI3MnKS52YWwoKSApIHtcclxuXHRcdFx0JCgnI3NlYXJjaGZvcm0nKS5zdWJtaXQoKTsgXHJcblx0XHR9IGVsc2Ugc2VhcmNoLmZhZGVUb2dnbGUoMzAwKTtcclxuXHR9KTtcclxuXHJcblx0JCgnI3NlYXJjaGZvcm0nKS5vbignc3VibWl0JywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdC8v0LjQtNC10YIg0L/QvtC40YHQui4uLlxyXG5cdFx0Ly/QvNC+0LbQvdC+INCy0YvQstC10YHRgtC4IHByZWxvYWRlciDRgSDQvdCw0LTQv9C40YHRjNGOXHJcblx0fSk7XHJcblxyXG5cdCQoJyNzZWFyY2hmb3JtLWNsb3NlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciBmaWVsZF9zID0gc2VhcmNoLmZpbmQoJyNzJyk7XHJcblx0XHRpZiAoIGZpZWxkX3MudmFsKCkgKSBmaWVsZF9zLnZhbCgnJylcclxuXHRcdGVsc2Ugc2VhcmNoLmZhZGVUb2dnbGUoMzAwKTtcclxuXHR9KTtcclxuXHJcblx0aWYgKCAkKCcuamNhcm91c2VsJykubGVuZ3RoID4gMCApIHtcclxuXHRcdHZhciBqID0gJChcIi5qY2Fyb3VzZWwtd3JhcHBlciBsaVwiKTtcclxuXHRcdGlmIChqLmxlbmd0aCA+IDApIGouY3NzKFwid2lkdGhcIiwgai5wYXJlbnRzKFwiLmpjYXJvdXNlbC13cmFwcGVyXCIpLmNzcyhcIndpZHRoXCIpKTtcclxuXHR9XHJcblx0XHJcblx0aWYgKCAkKCcuamNhcm91c2VsJykuaGFzKCcuaGVhZGVyLWJhY2tncm91bmQnKS5sZW5ndGggKSB7XHJcblxyXG5cdFx0JCgnW2RhdGEtamNhcm91c2VsXScpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBlbCA9ICQodGhpcyk7XHJcblx0XHRcdGVsLmpjYXJvdXNlbChlbC5kYXRhKCkpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0JCgnLmpjYXJvdXNlbCcpXHRcdFxyXG5cdFx0XHQub24oJ2pjYXJvdXNlbDpyZWxvYWRlbmQnLCBmdW5jdGlvbihldmVudCwgY2Fyb3VzZWwpIHtcclxuXHRcdFx0XHQkKHRoaXMpLmpjYXJvdXNlbCgndGFyZ2V0JykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuXHRcdFx0fSlcclxuXHRcdFx0Lm9uKCdqY2Fyb3VzZWw6dmlzaWJsZW91dCcsICdsaScsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdFx0XHR9KVxyXG5cdFx0XHQub24oJ2pjYXJvdXNlbDp2aXNpYmxlaW4nLCAnbGknLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0fSlcclxuXHRcdFx0LmpjYXJvdXNlbCh7XHJcblx0XHRcdFx0d3JhcDogJ2NpcmN1bGFyJyxcclxuXHRcdFx0XHRhbmltYXRpb246IDEwMDAsXHJcblx0XHRcdFx0dHJhbnNpdGlvbnM6IE1vZGVybml6ci5jc3N0cmFuc2l0aW9ucyA/IHtcclxuXHRcdFx0XHRcdHRyYW5zZm9ybXM6ICAgTW9kZXJuaXpyLmNzc3RyYW5zZm9ybXMsXHJcblx0XHRcdFx0XHR0cmFuc2Zvcm1zM2Q6IE1vZGVybml6ci5jc3N0cmFuc2Zvcm1zM2QsXHJcblx0XHRcdFx0XHRlYXNpbmc6ICAgICAgICdlYXNlJ1xyXG5cdFx0XHRcdH0gOiBmYWxzZVxyXG5cdFx0XHR9KVxyXG5cdFx0XHQuamNhcm91c2VsU3dpcGUoKTtcclxuXHJcblx0XHRcdGlmICggJ3RydWUnID09PSAkKCcuamNhcm91c2VsJykuYXR0cignZGF0YS1qY2Fyb3VzZWxhdXRvc2Nyb2xsJykgKSB7XHJcblx0XHRcdFx0JCgnLmpjYXJvdXNlbCcpLmpjYXJvdXNlbEF1dG9zY3JvbGwoe1xyXG5cdFx0XHRcdFx0aW50ZXJ2YWw6ICA1MDAwLFxyXG5cdFx0XHRcdFx0Ly9hdXRvc3RhcnQ6IGZhbHNlLFxyXG5cdFx0XHRcdFx0Ly90YXJnZXQ6ICctPTEnLFxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoICQoJy5qY2Fyb3VzZWwtd3JhcHBlcicpLmhhcygnLmpjYXJvdXNlbC1jb250cm9sJykubGVuZ3RoICkge1xyXG5cdFx0XHRcclxuXHRcdFx0JCgnLmpjYXJvdXNlbC1jb250cm9sLnByZXYnKVxyXG5cdFx0XHRcdC5vbignamNhcm91c2VsY29udHJvbDphY3RpdmUnLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ2luYWN0aXZlJyk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQub24oJ2pjYXJvdXNlbGNvbnRyb2w6aW5hY3RpdmUnLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQodGhpcykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQuamNhcm91c2VsQ29udHJvbCh7XHJcblx0XHRcdFx0XHR0YXJnZXQ6ICctPTEnXHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHQkKCcuamNhcm91c2VsLWNvbnRyb2wubmV4dCcpXHJcblx0XHRcdFx0Lm9uKCdqY2Fyb3VzZWxjb250cm9sOmFjdGl2ZScsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JCh0aGlzKS5yZW1vdmVDbGFzcygnaW5hY3RpdmUnKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5vbignamNhcm91c2VsY29udHJvbDppbmFjdGl2ZScsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygnaW5hY3RpdmUnKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5qY2Fyb3VzZWxDb250cm9sKHtcclxuXHRcdFx0XHRcdHRhcmdldDogJys9MSdcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdCQoXCIuamNhcm91c2VsLXdyYXBwZXJcIikuaG92ZXIoIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdCQoJy5qY2Fyb3VzZWwtY29udHJvbCcpLmZhZGVJbig3MDApO1xyXG5cdFx0XHR9LCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkKCcuamNhcm91c2VsLWNvbnRyb2wnKS5mYWRlT3V0KDcwMCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoICQoJy5qY2Fyb3VzZWwtd3JhcHBlcicpLmhhcygnLmpjYXJvdXNlbC1wYWdpbmF0aW9uJykubGVuZ3RoICYmICd0cnVlJyA9PT0gJCgnLmpjYXJvdXNlbC1wYWdpbmF0aW9uJykuYXR0cignZGF0YS1qY2Fyb3VzZWxwYWdpbmF0aW9uJykgKSB7XHJcblx0XHRcdCQoJy5qY2Fyb3VzZWwtcGFnaW5hdGlvbicpXHJcblx0XHRcdFx0Lm9uKCdqY2Fyb3VzZWxwYWdpbmF0aW9uOmFjdGl2ZScsICdhJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5vbignamNhcm91c2VscGFnaW5hdGlvbjppbmFjdGl2ZScsICdhJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5qY2Fyb3VzZWxQYWdpbmF0aW9uKCk7XHJcblx0XHR9IGVsc2UgJCgnLmpjYXJvdXNlbC1wYWdpbmF0aW9uJykucmVtb3ZlKCk7XHJcblx0fVxyXG5cclxuXHQvL0FkZGluZyBhbiBhZ2VudCB0byBIVE1MIHNlbGVjdG9yXHJcblx0dmFyIGRldmljZUFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xyXG5cdGlmIChkZXZpY2VBZ2VudC5tYXRjaCgvKGlwaG9uZXxpcG9kfGlwYWQpLykpIHtcclxuXHRcdCQoXCJodG1sXCIpLmFkZENsYXNzKFwiaW9zXCIpO1xyXG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJtb2JpbGVcIik7XHJcblx0fVxyXG5cdGlmIChuYXZpZ2F0b3IudXNlckFnZW50LnNlYXJjaChcIk1TSUVcIikgPj0gMCkge1xyXG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJpZVwiKTtcclxuXHR9XHJcblx0ZWxzZSBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goXCJDaHJvbWVcIikgPj0gMCkge1xyXG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJjaHJvbWVcIik7XHJcblx0fVxyXG5cdGVsc2UgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKFwiRmlyZWZveFwiKSA+PSAwKSB7XHJcblx0XHQkKFwiaHRtbFwiKS5hZGRDbGFzcyhcImZpcmVmb3hcIik7XHJcblx0fVxyXG5cdGVsc2UgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKFwiU2FmYXJpXCIpID49IDAgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goXCJDaHJvbWVcIikgPCAwKSB7XHJcblx0XHQkKFwiaHRtbFwiKS5hZGRDbGFzcyhcInNhZmFyaVwiKTtcclxuXHR9XHJcblx0ZWxzZSBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goXCJPcGVyYVwiKSA+PSAwKSB7XHJcblx0XHQkKFwiaHRtbFwiKS5hZGRDbGFzcyhcIm9wZXJhXCIpO1xyXG5cdH1cclxuXHJcbn0pO1xyXG4iXX0=
