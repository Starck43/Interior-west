/*
 * Custom scripts library
 *
 * @version 1.0.6
 */
	
function checkMobileNavgation(nav) {
	var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
	if (!nav.hasClass('burger'))
		if ( width < 768 ) nav.addClass('mobile')
		else nav.removeClass('mobile')
}

document.addEventListener('readystatechange', function(el) {
	if ( document.readyState === 'interactive' ) {
		// Adding class after full DOM loading for applying CSS animation
		//$('#main-header').addClass('visible');
		$.when( $('#dom-preloader').find('i').removeClass('fa-spin').end().delay(500).fadeOut('slow') )
		.done( function() { 
			$('body').fadeIn();
			$('#dom-preloader').remove(); 
		});		
	}
});

document.addEventListener("DOMContentLoaded", function() {

	var navigation = $('#header-nav');
	checkMobileNavgation(navigation);
	navigation.css('opacity', 1);
	var burger = $('#nav-burger');
	var mainheader = $('#main-header');
	var scrollup = $('#scroll-up');
	var search = $('#site-search-modal');
	var back2top = $('#back-to-top');

/*
// inView.js
	inView('.someSelector')
		.on('enter', el => {
			el.style.opacity =1;
			el.classList.add('visible');
		})
		.on('exit', el => {
			el.style.opacity = 0.5;
		});	
*/

	$( window ).on( 'resize', function( e ) {
		checkMobileNavgation(navigation);
		if (burger.hasClass('active')) burger.click(); // if burger menu open then close it 
	});

	$(window).scroll(function() {
		addVisibleClass(document.body.querySelectorAll('article')); //viewport.js
		addVisibleClass(document.body.querySelectorAll('#copyright'));

		$('#back-to-top').topBtnToggle({
			scrollTrigger: 1200,
			//debug: true,
		});

		if ( $('body').has('.parallax').length ) {
			// init parallax for background
			$('.parallax').bgParallax({
				bgpositionY: 50, //it must be the same background-position value in css 
				speed: 0.5,
			});
		}
	});

/*
// Click event on link starting from # for landing page
	$('a[href^="#"]').on('click', function (e) {
		e.preventDefault();
		var target = $(this).attr('href');
		if ( target.length > 1 && window.location.pathname == '/' && window.location.search == '') { //if home page and no search query and no only #
			//if ($(target).hasClass('animate')) $(target).removeClass('animate');
			if (burger.is(':visible')) burger.click(); //close burger menu on link clicking

			var top = $(target).offset().top;
			$('html, body').animate({scrollTop: top}, 500+top/4); //800 - длительность скроллинга в мс			
		} else {
			//target = target.replace(/[^A-Za-z]/g, "");
			location.replace('/'+target);
		}
	});

*/	burger.on('click', function (e) {
		if (burger.is(':visible')) {
			burger.toggleClass('active');
			$('#menu-top').toggleClass('active');
			$(document.body).toggleClass('modal');
		}
	});

	var submenu_item = $('.menu-item-has-children a').on('click', function (e) {
		e.preventDefault();
		$(this).parent().toggleClass('collapsed');
	});
		
	$( document ).on( 'keyup', function (e) {
		e.preventDefault();
		if( e.keyCode == 27 && search.is(':visible') )
			search.fadeToggle(300) //close search form
		else
		if( e.keyCode == 27 && burger.hasClass('active') ) burger.click(); // close burger menu on esc key
	});
	
	scrollup.on('click', function (e) {
		var mc = document.body.querySelector('#main-container');
		scrollup
		.fadeOut('slow')
		.delay(500)
		.remove()
		.delay(500)
		.queue( function() {
			mc.scrollIntoView({block: "start", behavior: "smooth"});
		});
	});

	back2top.on('click', function (e) {		
		// 800 - скорость задержки перемещения наверх (в миллисекундах)
		e.preventDefault();
		$('html,body').animate({scrollTop: 0}, 800);		
	});

	$('#nav-search').on('click', function (e) {
		if ( !search.attr('display','none') && search.find('#s').val() ) {
			$('#searchform').submit(); 
		} else search.fadeToggle(300);
	});

	$('#searchform').on('submit', function (e) {
		//идет поиск...
		//можно вывести preloader с надписью
	});

	$('#searchform-close').on('click', function (e) {
		var field_s = search.find('#s');
		if ( field_s.val() ) field_s.val('')
		else search.fadeToggle(300);
	});

	if ( $('.jcarousel').length > 0 ) {
		var j = $(".jcarousel-wrapper li");
		if (j.length > 0) j.css("width", j.parents(".jcarousel-wrapper").css("width"));
	}
	
	if ( $('.jcarousel').has('.header-background').length ) {

		$('[data-jcarousel]').each(function() {
			var el = $(this);
			el.jcarousel(el.data());
		});

		$('.jcarousel')		
			.on('jcarousel:reloadend', function(event, carousel) {
				$(this).jcarousel('target').addClass('active');

			})
			.on('jcarousel:visibleout', 'li', function() {
				$(this).removeClass('active');
			})
			.on('jcarousel:visiblein', 'li', function() {
				$(this).addClass('active');
			})
			.jcarousel({
				wrap: 'circular',
				animation: 1000,
				transitions: Modernizr.csstransitions ? {
					transforms:   Modernizr.csstransforms,
					transforms3d: Modernizr.csstransforms3d,
					easing:       'ease'
				} : false
			})
			.jcarouselSwipe();

			if ( 'true' === $('.jcarousel').attr('data-jcarouselautoscroll') ) {
				$('.jcarousel').jcarouselAutoscroll({
					interval:  5000,
					//autostart: false,
					//target: '-=1',
				});
			}

			if ( $('.jcarousel-wrapper').has('.jcarousel-control').length ) {
			
			$('.jcarousel-control.prev')
				.on('jcarouselcontrol:active', function() {
					$(this).removeClass('inactive');
				})
				.on('jcarouselcontrol:inactive', function() {
					$(this).addClass('inactive');
				})
				.jcarouselControl({
					target: '-=1'
				});

			$('.jcarousel-control.next')
				.on('jcarouselcontrol:active', function() {
					$(this).removeClass('inactive');
				})
				.on('jcarouselcontrol:inactive', function() {
					$(this).addClass('inactive');
				})
				.jcarouselControl({
					target: '+=1'
				});

			$(".jcarousel-wrapper").hover( function() {
				$('.jcarousel-control').fadeIn(700);
			}, function() {
				$('.jcarousel-control').fadeOut(700);
			});

		}

		if ( $('.jcarousel-wrapper').has('.jcarousel-pagination').length && 'true' === $('.jcarousel-pagination').attr('data-jcarouselpagination') ) {
			$('.jcarousel-pagination')
				.on('jcarouselpagination:active', 'a', function() {
					$(this).addClass('active');
				})
				.on('jcarouselpagination:inactive', 'a', function() {
					$(this).removeClass('active');
				})
				.jcarouselPagination();
		} else $('.jcarousel-pagination').remove();
	}

	//Adding an agent to HTML selector
	var deviceAgent = navigator.userAgent.toLowerCase();
	if (deviceAgent.match(/(iphone|ipod|ipad)/)) {
		$("html").addClass("ios");
		$("html").addClass("mobile");
	}
	if (navigator.userAgent.search("MSIE") >= 0) {
		$("html").addClass("ie");
	}
	else if (navigator.userAgent.search("Chrome") >= 0) {
		$("html").addClass("chrome");
	}
	else if (navigator.userAgent.search("Firefox") >= 0) {
		$("html").addClass("firefox");
	}
	else if (navigator.userAgent.search("Safari") >= 0 && navigator.userAgent.search("Chrome") < 0) {
		$("html").addClass("safari");
	}
	else if (navigator.userAgent.search("Opera") >= 0) {
		$("html").addClass("opera");
	}

});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImN1c3RvbS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDdXN0b20gc2NyaXB0cyBsaWJyYXJ5XHJcbiAqXHJcbiAqIEB2ZXJzaW9uIDEuMC42XHJcbiAqL1xyXG5cdFxyXG5mdW5jdGlvbiBjaGVja01vYmlsZU5hdmdhdGlvbihuYXYpIHtcclxuXHR2YXIgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDtcclxuXHRpZiAoIW5hdi5oYXNDbGFzcygnYnVyZ2VyJykpXHJcblx0XHRpZiAoIHdpZHRoIDwgNzY4ICkgbmF2LmFkZENsYXNzKCdtb2JpbGUnKVxyXG5cdFx0ZWxzZSBuYXYucmVtb3ZlQ2xhc3MoJ21vYmlsZScpXHJcbn1cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3JlYWR5c3RhdGVjaGFuZ2UnLCBmdW5jdGlvbihlbCkge1xyXG5cdGlmICggZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2ludGVyYWN0aXZlJyApIHtcclxuXHRcdC8vIEFkZGluZyBjbGFzcyBhZnRlciBmdWxsIERPTSBsb2FkaW5nIGZvciBhcHBseWluZyBDU1MgYW5pbWF0aW9uXHJcblx0XHQvLyQoJyNtYWluLWhlYWRlcicpLmFkZENsYXNzKCd2aXNpYmxlJyk7XHJcblx0XHQkLndoZW4oICQoJyNkb20tcHJlbG9hZGVyJykuZmluZCgnaScpLnJlbW92ZUNsYXNzKCdmYS1zcGluJykuZW5kKCkuZGVsYXkoNTAwKS5mYWRlT3V0KCdzbG93JykgKVxyXG5cdFx0LmRvbmUoIGZ1bmN0aW9uKCkgeyBcclxuXHRcdFx0JCgnYm9keScpLmZhZGVJbigpO1xyXG5cdFx0XHQkKCcjZG9tLXByZWxvYWRlcicpLnJlbW92ZSgpOyBcclxuXHRcdH0pO1x0XHRcclxuXHR9XHJcbn0pO1xyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oKSB7XHJcblxyXG5cdHZhciBuYXZpZ2F0aW9uID0gJCgnI2hlYWRlci1uYXYnKTtcclxuXHRjaGVja01vYmlsZU5hdmdhdGlvbihuYXZpZ2F0aW9uKTtcclxuXHRuYXZpZ2F0aW9uLmNzcygnb3BhY2l0eScsIDEpO1xyXG5cdHZhciBidXJnZXIgPSAkKCcjbmF2LWJ1cmdlcicpO1xyXG5cdHZhciBtYWluaGVhZGVyID0gJCgnI21haW4taGVhZGVyJyk7XHJcblx0dmFyIHNjcm9sbHVwID0gJCgnI3Njcm9sbC11cCcpO1xyXG5cdHZhciBzZWFyY2ggPSAkKCcjc2l0ZS1zZWFyY2gtbW9kYWwnKTtcclxuXHR2YXIgYmFjazJ0b3AgPSAkKCcjYmFjay10by10b3AnKTtcclxuXHJcbi8qXHJcbi8vIGluVmlldy5qc1xyXG5cdGluVmlldygnLnNvbWVTZWxlY3RvcicpXHJcblx0XHQub24oJ2VudGVyJywgZWwgPT4ge1xyXG5cdFx0XHRlbC5zdHlsZS5vcGFjaXR5ID0xO1xyXG5cdFx0XHRlbC5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XHJcblx0XHR9KVxyXG5cdFx0Lm9uKCdleGl0JywgZWwgPT4ge1xyXG5cdFx0XHRlbC5zdHlsZS5vcGFjaXR5ID0gMC41O1xyXG5cdFx0fSk7XHRcclxuKi9cclxuXHJcblx0JCggd2luZG93ICkub24oICdyZXNpemUnLCBmdW5jdGlvbiggZSApIHtcclxuXHRcdGNoZWNrTW9iaWxlTmF2Z2F0aW9uKG5hdmlnYXRpb24pO1xyXG5cdFx0aWYgKGJ1cmdlci5oYXNDbGFzcygnYWN0aXZlJykpIGJ1cmdlci5jbGljaygpOyAvLyBpZiBidXJnZXIgbWVudSBvcGVuIHRoZW4gY2xvc2UgaXQgXHJcblx0fSk7XHJcblxyXG5cdCQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7XHJcblx0XHRhZGRWaXNpYmxlQ2xhc3MoZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCdhcnRpY2xlJykpOyAvL3ZpZXdwb3J0LmpzXHJcblx0XHRhZGRWaXNpYmxlQ2xhc3MoZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcjY29weXJpZ2h0JykpO1xyXG5cclxuXHRcdCQoJyNiYWNrLXRvLXRvcCcpLnRvcEJ0blRvZ2dsZSh7XHJcblx0XHRcdHNjcm9sbFRyaWdnZXI6IDEyMDAsXHJcblx0XHRcdC8vZGVidWc6IHRydWUsXHJcblx0XHR9KTtcclxuXHJcblx0XHRpZiAoICQoJ2JvZHknKS5oYXMoJy5wYXJhbGxheCcpLmxlbmd0aCApIHtcclxuXHRcdFx0Ly8gaW5pdCBwYXJhbGxheCBmb3IgYmFja2dyb3VuZFxyXG5cdFx0XHQkKCcucGFyYWxsYXgnKS5iZ1BhcmFsbGF4KHtcclxuXHRcdFx0XHRiZ3Bvc2l0aW9uWTogNTAsIC8vaXQgbXVzdCBiZSB0aGUgc2FtZSBiYWNrZ3JvdW5kLXBvc2l0aW9uIHZhbHVlIGluIGNzcyBcclxuXHRcdFx0XHRzcGVlZDogMC41LFxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcbi8qXHJcbi8vIENsaWNrIGV2ZW50IG9uIGxpbmsgc3RhcnRpbmcgZnJvbSAjIGZvciBsYW5kaW5nIHBhZ2VcclxuXHQkKCdhW2hyZWZePVwiI1wiXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHR2YXIgdGFyZ2V0ID0gJCh0aGlzKS5hdHRyKCdocmVmJyk7XHJcblx0XHRpZiAoIHRhcmdldC5sZW5ndGggPiAxICYmIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PSAnLycgJiYgd2luZG93LmxvY2F0aW9uLnNlYXJjaCA9PSAnJykgeyAvL2lmIGhvbWUgcGFnZSBhbmQgbm8gc2VhcmNoIHF1ZXJ5IGFuZCBubyBvbmx5ICNcclxuXHRcdFx0Ly9pZiAoJCh0YXJnZXQpLmhhc0NsYXNzKCdhbmltYXRlJykpICQodGFyZ2V0KS5yZW1vdmVDbGFzcygnYW5pbWF0ZScpO1xyXG5cdFx0XHRpZiAoYnVyZ2VyLmlzKCc6dmlzaWJsZScpKSBidXJnZXIuY2xpY2soKTsgLy9jbG9zZSBidXJnZXIgbWVudSBvbiBsaW5rIGNsaWNraW5nXHJcblxyXG5cdFx0XHR2YXIgdG9wID0gJCh0YXJnZXQpLm9mZnNldCgpLnRvcDtcclxuXHRcdFx0JCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe3Njcm9sbFRvcDogdG9wfSwgNTAwK3RvcC80KTsgLy84MDAgLSDQtNC70LjRgtC10LvRjNC90L7RgdGC0Ywg0YHQutGA0L7Qu9C70LjQvdCz0LAg0LIg0LzRgVx0XHRcdFxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly90YXJnZXQgPSB0YXJnZXQucmVwbGFjZSgvW15BLVphLXpdL2csIFwiXCIpO1xyXG5cdFx0XHRsb2NhdGlvbi5yZXBsYWNlKCcvJyt0YXJnZXQpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuKi9cdGJ1cmdlci5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG5cdFx0aWYgKGJ1cmdlci5pcygnOnZpc2libGUnKSkge1xyXG5cdFx0XHRidXJnZXIudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdFx0XHQkKCcjbWVudS10b3AnKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdCQoZG9jdW1lbnQuYm9keSkudG9nZ2xlQ2xhc3MoJ21vZGFsJyk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHZhciBzdWJtZW51X2l0ZW0gPSAkKCcubWVudS1pdGVtLWhhcy1jaGlsZHJlbiBhJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdCQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG5cdH0pO1xyXG5cdFx0XHJcblx0JCggZG9jdW1lbnQgKS5vbiggJ2tleXVwJywgZnVuY3Rpb24gKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdGlmKCBlLmtleUNvZGUgPT0gMjcgJiYgc2VhcmNoLmlzKCc6dmlzaWJsZScpIClcclxuXHRcdFx0c2VhcmNoLmZhZGVUb2dnbGUoMzAwKSAvL2Nsb3NlIHNlYXJjaCBmb3JtXHJcblx0XHRlbHNlXHJcblx0XHRpZiggZS5rZXlDb2RlID09IDI3ICYmIGJ1cmdlci5oYXNDbGFzcygnYWN0aXZlJykgKSBidXJnZXIuY2xpY2soKTsgLy8gY2xvc2UgYnVyZ2VyIG1lbnUgb24gZXNjIGtleVxyXG5cdH0pO1xyXG5cdFxyXG5cdHNjcm9sbHVwLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHR2YXIgbWMgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyNtYWluLWNvbnRhaW5lcicpO1xyXG5cdFx0c2Nyb2xsdXBcclxuXHRcdC5mYWRlT3V0KCdzbG93JylcclxuXHRcdC5kZWxheSg1MDApXHJcblx0XHQucmVtb3ZlKClcclxuXHRcdC5kZWxheSg1MDApXHJcblx0XHQucXVldWUoIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRtYy5zY3JvbGxJbnRvVmlldyh7YmxvY2s6IFwic3RhcnRcIiwgYmVoYXZpb3I6IFwic21vb3RoXCJ9KTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG5cclxuXHRiYWNrMnRvcC5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1x0XHRcclxuXHRcdC8vIDgwMCAtINGB0LrQvtGA0L7RgdGC0Ywg0LfQsNC00LXRgNC20LrQuCDQv9C10YDQtdC80LXRidC10L3QuNGPINC90LDQstC10YDRhSAo0LIg0LzQuNC70LvQuNGB0LXQutGD0L3QtNCw0YUpXHJcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHQkKCdodG1sLGJvZHknKS5hbmltYXRlKHtzY3JvbGxUb3A6IDB9LCA4MDApO1x0XHRcclxuXHR9KTtcclxuXHJcblx0JCgnI25hdi1zZWFyY2gnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG5cdFx0aWYgKCAhc2VhcmNoLmF0dHIoJ2Rpc3BsYXknLCdub25lJykgJiYgc2VhcmNoLmZpbmQoJyNzJykudmFsKCkgKSB7XHJcblx0XHRcdCQoJyNzZWFyY2hmb3JtJykuc3VibWl0KCk7IFxyXG5cdFx0fSBlbHNlIHNlYXJjaC5mYWRlVG9nZ2xlKDMwMCk7XHJcblx0fSk7XHJcblxyXG5cdCQoJyNzZWFyY2hmb3JtJykub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHQvL9C40LTQtdGCINC/0L7QuNGB0LouLi5cclxuXHRcdC8v0LzQvtC20L3QviDQstGL0LLQtdGB0YLQuCBwcmVsb2FkZXIg0YEg0L3QsNC00L/QuNGB0YzRjlxyXG5cdH0pO1xyXG5cclxuXHQkKCcjc2VhcmNoZm9ybS1jbG9zZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHR2YXIgZmllbGRfcyA9IHNlYXJjaC5maW5kKCcjcycpO1xyXG5cdFx0aWYgKCBmaWVsZF9zLnZhbCgpICkgZmllbGRfcy52YWwoJycpXHJcblx0XHRlbHNlIHNlYXJjaC5mYWRlVG9nZ2xlKDMwMCk7XHJcblx0fSk7XHJcblxyXG5cdGlmICggJCgnLmpjYXJvdXNlbCcpLmxlbmd0aCA+IDAgKSB7XHJcblx0XHR2YXIgaiA9ICQoXCIuamNhcm91c2VsLXdyYXBwZXIgbGlcIik7XHJcblx0XHRpZiAoai5sZW5ndGggPiAwKSBqLmNzcyhcIndpZHRoXCIsIGoucGFyZW50cyhcIi5qY2Fyb3VzZWwtd3JhcHBlclwiKS5jc3MoXCJ3aWR0aFwiKSk7XHJcblx0fVxyXG5cdFxyXG5cdGlmICggJCgnLmpjYXJvdXNlbCcpLmhhcygnLmhlYWRlci1iYWNrZ3JvdW5kJykubGVuZ3RoICkge1xyXG5cclxuXHRcdCQoJ1tkYXRhLWpjYXJvdXNlbF0nKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgZWwgPSAkKHRoaXMpO1xyXG5cdFx0XHRlbC5qY2Fyb3VzZWwoZWwuZGF0YSgpKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdCQoJy5qY2Fyb3VzZWwnKVx0XHRcclxuXHRcdFx0Lm9uKCdqY2Fyb3VzZWw6cmVsb2FkZW5kJywgZnVuY3Rpb24oZXZlbnQsIGNhcm91c2VsKSB7XHJcblx0XHRcdFx0JCh0aGlzKS5qY2Fyb3VzZWwoJ3RhcmdldCcpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcblx0XHRcdH0pXHJcblx0XHRcdC5vbignamNhcm91c2VsOnZpc2libGVvdXQnLCAnbGknLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0fSlcclxuXHRcdFx0Lm9uKCdqY2Fyb3VzZWw6dmlzaWJsZWluJywgJ2xpJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdH0pXHJcblx0XHRcdC5qY2Fyb3VzZWwoe1xyXG5cdFx0XHRcdHdyYXA6ICdjaXJjdWxhcicsXHJcblx0XHRcdFx0YW5pbWF0aW9uOiAxMDAwLFxyXG5cdFx0XHRcdHRyYW5zaXRpb25zOiBNb2Rlcm5penIuY3NzdHJhbnNpdGlvbnMgPyB7XHJcblx0XHRcdFx0XHR0cmFuc2Zvcm1zOiAgIE1vZGVybml6ci5jc3N0cmFuc2Zvcm1zLFxyXG5cdFx0XHRcdFx0dHJhbnNmb3JtczNkOiBNb2Rlcm5penIuY3NzdHJhbnNmb3JtczNkLFxyXG5cdFx0XHRcdFx0ZWFzaW5nOiAgICAgICAnZWFzZSdcclxuXHRcdFx0XHR9IDogZmFsc2VcclxuXHRcdFx0fSlcclxuXHRcdFx0LmpjYXJvdXNlbFN3aXBlKCk7XHJcblxyXG5cdFx0XHRpZiAoICd0cnVlJyA9PT0gJCgnLmpjYXJvdXNlbCcpLmF0dHIoJ2RhdGEtamNhcm91c2VsYXV0b3Njcm9sbCcpICkge1xyXG5cdFx0XHRcdCQoJy5qY2Fyb3VzZWwnKS5qY2Fyb3VzZWxBdXRvc2Nyb2xsKHtcclxuXHRcdFx0XHRcdGludGVydmFsOiAgNTAwMCxcclxuXHRcdFx0XHRcdC8vYXV0b3N0YXJ0OiBmYWxzZSxcclxuXHRcdFx0XHRcdC8vdGFyZ2V0OiAnLT0xJyxcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCAkKCcuamNhcm91c2VsLXdyYXBwZXInKS5oYXMoJy5qY2Fyb3VzZWwtY29udHJvbCcpLmxlbmd0aCApIHtcclxuXHRcdFx0XHJcblx0XHRcdCQoJy5qY2Fyb3VzZWwtY29udHJvbC5wcmV2JylcclxuXHRcdFx0XHQub24oJ2pjYXJvdXNlbGNvbnRyb2w6YWN0aXZlJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKCdpbmFjdGl2ZScpO1xyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0Lm9uKCdqY2Fyb3VzZWxjb250cm9sOmluYWN0aXZlJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpLmFkZENsYXNzKCdpbmFjdGl2ZScpO1xyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0LmpjYXJvdXNlbENvbnRyb2woe1xyXG5cdFx0XHRcdFx0dGFyZ2V0OiAnLT0xJ1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0JCgnLmpjYXJvdXNlbC1jb250cm9sLm5leHQnKVxyXG5cdFx0XHRcdC5vbignamNhcm91c2VsY29udHJvbDphY3RpdmUnLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ2luYWN0aXZlJyk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQub24oJ2pjYXJvdXNlbGNvbnRyb2w6aW5hY3RpdmUnLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdCQodGhpcykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQuamNhcm91c2VsQ29udHJvbCh7XHJcblx0XHRcdFx0XHR0YXJnZXQ6ICcrPTEnXHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHQkKFwiLmpjYXJvdXNlbC13cmFwcGVyXCIpLmhvdmVyKCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkKCcuamNhcm91c2VsLWNvbnRyb2wnKS5mYWRlSW4oNzAwKTtcclxuXHRcdFx0fSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0JCgnLmpjYXJvdXNlbC1jb250cm9sJykuZmFkZU91dCg3MDApO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCAkKCcuamNhcm91c2VsLXdyYXBwZXInKS5oYXMoJy5qY2Fyb3VzZWwtcGFnaW5hdGlvbicpLmxlbmd0aCAmJiAndHJ1ZScgPT09ICQoJy5qY2Fyb3VzZWwtcGFnaW5hdGlvbicpLmF0dHIoJ2RhdGEtamNhcm91c2VscGFnaW5hdGlvbicpICkge1xyXG5cdFx0XHQkKCcuamNhcm91c2VsLXBhZ2luYXRpb24nKVxyXG5cdFx0XHRcdC5vbignamNhcm91c2VscGFnaW5hdGlvbjphY3RpdmUnLCAnYScsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQub24oJ2pjYXJvdXNlbHBhZ2luYXRpb246aW5hY3RpdmUnLCAnYScsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0JCh0aGlzKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQuamNhcm91c2VsUGFnaW5hdGlvbigpO1xyXG5cdFx0fSBlbHNlICQoJy5qY2Fyb3VzZWwtcGFnaW5hdGlvbicpLnJlbW92ZSgpO1xyXG5cdH1cclxuXHJcblx0Ly9BZGRpbmcgYW4gYWdlbnQgdG8gSFRNTCBzZWxlY3RvclxyXG5cdHZhciBkZXZpY2VBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcclxuXHRpZiAoZGV2aWNlQWdlbnQubWF0Y2goLyhpcGhvbmV8aXBvZHxpcGFkKS8pKSB7XHJcblx0XHQkKFwiaHRtbFwiKS5hZGRDbGFzcyhcImlvc1wiKTtcclxuXHRcdCQoXCJodG1sXCIpLmFkZENsYXNzKFwibW9iaWxlXCIpO1xyXG5cdH1cclxuXHRpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goXCJNU0lFXCIpID49IDApIHtcclxuXHRcdCQoXCJodG1sXCIpLmFkZENsYXNzKFwiaWVcIik7XHJcblx0fVxyXG5cdGVsc2UgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKFwiQ2hyb21lXCIpID49IDApIHtcclxuXHRcdCQoXCJodG1sXCIpLmFkZENsYXNzKFwiY2hyb21lXCIpO1xyXG5cdH1cclxuXHRlbHNlIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LnNlYXJjaChcIkZpcmVmb3hcIikgPj0gMCkge1xyXG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJmaXJlZm94XCIpO1xyXG5cdH1cclxuXHRlbHNlIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LnNlYXJjaChcIlNhZmFyaVwiKSA+PSAwICYmIG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKFwiQ2hyb21lXCIpIDwgMCkge1xyXG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJzYWZhcmlcIik7XHJcblx0fVxyXG5cdGVsc2UgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKFwiT3BlcmFcIikgPj0gMCkge1xyXG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJvcGVyYVwiKTtcclxuXHR9XHJcblxyXG59KTtcclxuIl19
