/*
 * Custom scripts library
 *
 * @version 1.8.5
 */

var $ = jQuery.noConflict();
var width;

function checkMobileNavgation(nav) {
	width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
	//height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
	if (!nav.hasClass('burger'))
		if ( width < 992 ) nav.addClass('mobile')
		else nav.removeClass('mobile')
}

document.addEventListener('readystatechange', function(el) {
	if ( document.readyState === 'interactive' ) {}
});

document.addEventListener("DOMContentLoaded", function() {

	$('#dom-preloader').fadeOut(500, function() {
		//$('#dom-preloader').remove();
	});
	$('body').fadeIn(500);
	var overlay = $('#overlay');
	var navigation = $('#header-nav');
	checkMobileNavgation(navigation);
	navigation.css('opacity', 1);
	var burger = $('#nav-burger');
	var mobileMenu = $('ul.primary-menu');
	var mainheader = $('#main-header');
	if (mainheader) mainheader.addClass('visible');
	var scrollup = $('#scroll-up');
	var search = $('#site-search-modal');
	var back2top = $('#link-to-top');
	var gotoBack = $('#link-to-back:not(.show-in-top)');
/*
	var stopScroll;
	var scrollPos_Y;

	function disableScroll() {
		scrollPos_Y = $(window).scrollTop();
		stopScroll = true;
		$('body').addClass('scroll-disabled').css('margin-top', -scrollPos_Y + 'px');

		//$('#overlay .image-box').on("touchmove", function(e) { e.stopPropagation(); });
	}

	function enableScroll() {
		stopScroll = false;
		$('body').removeClass('scroll-disabled').css('margin-top', 0);
		$(window).scrollTop(scrollPos_Y);

		//$('#overlay .image-box').unbind("touchmove");
	}

	function disableTouchMove() {
		document.ontouchmove = function(e) { e.preventDefault(); }
		return true;
	}

	function enableTouchMove() {
		document.ontouchmove = function() { return true; }
		return false;
	}
*/
	// in vewport check script
	inView.offset(0);
	inView('h1')
		.on('enter', el => {
			//el.style.opacity = 1;
			el.classList.add('in-view');
		})
		.on('exit', el => {
			//el.style.opacity = 0.5;
		});
	inView('h2')
		.on('enter', el => {
			el.classList.add('in-view');
		});
	inView('.entry-content .wp-block-group__inner-container')
		.on('enter', el => {
			el.classList.add('in-view');
		});


	$( window ).on( 'resize', function( e ) {
		checkMobileNavgation(navigation);

		if (mobileMenu.hasClass('active')) burger.click(); // if burger menu open then close it
	});

	$(window).scroll(function() {
		//addVisibleClass(document.body.querySelectorAll('article')); //viewport.js

		back2top && back2top.topBtnToggle({
			scrollTrigger: 1000,
			//debug: true,
		});
/*
		gotoBack && gotoBack.topBtnToggle({
			scrollTrigger: 1000,
			//debug: true,
		});

		if ( $('body').has('.parallax').length ) {
			// init parallax for background
			$('.parallax').bgParallax({
				bgpositionY: 50, //it must be the same background-position value in css
				speed: 0.5,
			});
		}*/
	});


/*
// Click event on link starting from # for landing page
	$('a[href^="#"]').on('click', function (e) {
		e.preventDefault();
		var target = $(this).attr('href');
		if ( target.length > 1 && window.location.pathname == '/' && window.location.search == '') { //if home page and no search query and no only #
			//if ($(target).hasClass('animate')) $(target).removeClass('animate');
			if (burger.is(':visible')) burger.click(); //close burger menu on link clicking

			var top = $(target).offset().top;
			$('html, body').animate({scrollTop: top}, 500+top/4); //800 - длительность скроллинга в мс
		} else {
			//target = target.replace(/[^A-Za-z]/g, "");
			location.replace('/'+target);
		}
	});

*/
/*
	burger.on('click', function (e) {
		if (burger.is(':visible')) {
			burger.toggleClass('active');
			$('#menu-top').toggleClass('active');
			$(document.body).toggleClass('modal');
		}
	});
*/

	//New version with own close button in menu
	burger.on('click', function (e) {
		if (!mobileMenu.hasClass('active')) {
			mobileMenu.prepend('<div class="close-icon"></div>');
			//burger.toggleClass('active');
			mobileMenu.addClass('active');
			//$(document.body).toggleClass('modal');
		}
	});

	mobileMenu.on('click','.close-icon', function (e) {
		mobileMenu.removeClass('active').children().remove('.close-icon');
	});
/*
	var submenu_item = $('.menu-item-has-children a').on('click', function (e) {
		e.preventDefault();
		$(this).parent().toggleClass('collapsed');
	});
*/
	$( document ).on( 'keyup', function (e) {
		e.preventDefault();
		if( e.keyCode == 27 && search.is(':visible') )
			search.fadeToggle(300) //close search form
		else
		if( e.keyCode == 27 && !overlay.hasClass('hidden') )
			overlay.click() //close overlay form
		else //close burger menu on esc key
		if( e.keyCode == 27 && mobileMenu.hasClass('active') ) mobileMenu.children('.close-icon').click(); // if( e.keyCode == 27 && burger.hasClass('active') ) burger.click();
	});

/*
	scrollup.on('click', function (e) {
		var mc = document.body.querySelector('#main-container');
		scrollup
		.fadeOut('slow')
		.delay(500)
		.remove()
		.delay(500)
		.queue( function() {
			mc.scrollIntoView({block: "start", behavior: "smooth"});
		});
	});
*/
	back2top.on('click', function (e) {
		// 800 - скорость задержки перемещения наверх (в миллисекундах)
		e.preventDefault();
		$('html,body').animate({scrollTop: 0}, 800);
	});

	$('#nav-search').on('click', function (e) {
		if ( !search.attr('display','none') && search.find('#s').val() ) {
			$('#searchform').submit();
		} else search.fadeToggle(300);
	});

	$('#search-close').on('click', function (e) {
		var field_s = search.find('#s');
		if ( field_s.val() ) field_s.val('')
		else search.fadeToggle(300);
	});

	overlay.on('click', function (e) {
		$(this).addClass('hidden');
		enableScroll();
	});
/*
	if ( $('.jcarousel').has('li.slide').length ) {

		$('[data-jcarousel]').each(function() {
			var el = $(this);
			el.jcarousel(el.data());
		});

		var xStart, yStart;
		var stopTouch;
		var slidesPerPage = 1;

		var carousel = $('.jcarousel');
		carousel
			.on('jcarousel:create jcarousel:reload', function() {
				var carousel_w = carousel.parent().innerWidth(),
					carousel_h = carousel.parent().innerHeight();

				slidesPerPage = (carousel_w > carousel_h) ? Math.trunc(  carousel_w / carousel_h ) : 1;

				var slide_width = Math.ceil( carousel_w / slidesPerPage );
				carousel.jcarousel('items').css("width", slide_width + 'px');
			})
			.on('touchstart', function(e) {
				xStart = e.touches[0].screenX;
				yStart = e.touches[0].screenY;
				stopTouch = null;
			})
			.on('touchmove', function(e) {
				var xMovement = Math.abs(e.touches[0].screenX - xStart);
				var yMovement = Math.abs(e.touches[0].screenY - yStart);
				if (stopTouch == null && (xMovement > 10 || yMovement > 10))
					stopTouch = (yMovement < xMovement) ? disableTouchMove() : enableTouchMove();
			})
			.on('touchend touchcancel', function() {
				stopTouch && enableTouchMove();
			})
			.on('jcarousel:createend jcarousel:animateend', function() {
				$(this).jcarousel('target').addClass('active');
			})
			.on('jcarousel:visibleout', 'li', function() {
				$(this).removeClass('active');
			})
			.on('click', 'li', function (e) {
				var src = $(this).attr('src-url');
				if (src) {
					src = 'url('+src+')';
					//var bg = $(e.target).css('background-image');
					//bg = bg.replace('url(','').replace(')','').replace(/\"/gi, "");
					!overlay.children('.imagebox').length && overlay.append('<div class="imagebox"></div><div class="close close-icon" title="Close"></div>');
					overlay.children('.imagebox').css('background-image', src).parent().removeClass('hidden');
					disableScroll();
				}
			})
			.jcarousel({
				//scroll: slidesPerPage,
				//center: true,
				wrap: 'circular',
				animation: 500,
				//transitions: true,
				transitions: Modernizr.csstransitions ? {
					transforms:   Modernizr.csstransforms,
					transforms3d: Modernizr.csstransforms3d,
					easing:       'ease'
				} : false
			})
			//.jcarousel('scroll', '+='+String(slidesPerPage))
			.jcarouselSwipe({
				//perSwipe: slidesPerPage
				//method: 'scrollIntoView' // by default 'scroll'
			});

			if ( 'true' === carousel.attr('data-jcarouselautoscroll') ) {
				carousel.jcarouselAutoscroll({
					interval:  5000,
					//autostart: false,
					//target: '-=1'+String(slidesPerPage)
				});
			}

			if ( $('.jcarousel-wrapper').has('.jcarousel-control').length ) {

				$('.jcarousel-control.prev')
					.on('jcarouselcontrol:active', function() {
						$(this).removeClass('inactive');
					})
					.on('jcarouselcontrol:inactive', function() {
						$(this).addClass('inactive');
					})
					.jcarouselControl({
						//target: '-='+String(slidesPerPage)
					});

				$('.jcarousel-control.next')
					.on('jcarouselcontrol:active', function() {
						$(this).removeClass('inactive');
					})
					.on('jcarouselcontrol:inactive', function() {
						$(this).addClass('inactive');
					})
					.jcarouselControl({
						//target: '+='+String(slidesPerPage)
					});
			}

		if ( $('.jcarousel-wrapper').has('.jcarousel-pagination').length && 'true' === $('.jcarousel-pagination').attr('data-jcarouselpagination') ) {
			$('.jcarousel-pagination')
				.on('jcarouselpagination:active', 'a', function() {
					$(this).addClass('active');
				})
				.on('jcarouselpagination:inactive', 'a', function() {
					$(this).removeClass('active');
				})
				.jcarouselPagination({
					//'perPage': slidesPerPage
				});
		} else $('.jcarousel-pagination').remove();

	}
*/

/*
	//Adding an agent to HTML selector
	var deviceAgent = navigator.userAgent.toLowerCase();
	if (deviceAgent.match(/(iphone|ipod|ipad)/)) {
		$("html").addClass("mobile");
		$("html").addClass("ios");
	}
	if (navigator.userAgent.search("MSIE") >= 0) {
		$("html").addClass("ie");
	}
	else if (navigator.userAgent.search("Chrome") >= 0) {
		$("html").addClass("chrome");
	}
	else if (navigator.userAgent.search("Firefox") >= 0) {
		$("html").addClass("firefox");
	}
	else if (navigator.userAgent.search("Safari") >= 0 && navigator.userAgent.search("Chrome") < 0) {
		$("html").addClass("safari");
	}
	else if (navigator.userAgent.search("Opera") >= 0) {
		$("html").addClass("opera");
	}
*/
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiY3VzdG9tLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDdXN0b20gc2NyaXB0cyBsaWJyYXJ5XG4gKlxuICogQHZlcnNpb24gMS44LjVcbiAqL1xuXG52YXIgJCA9IGpRdWVyeS5ub0NvbmZsaWN0KCk7XG52YXIgd2lkdGg7XG5cbmZ1bmN0aW9uIGNoZWNrTW9iaWxlTmF2Z2F0aW9uKG5hdikge1xuXHR3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoO1xuXHQvL2hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0O1xuXHRpZiAoIW5hdi5oYXNDbGFzcygnYnVyZ2VyJykpXG5cdFx0aWYgKCB3aWR0aCA8IDk5MiApIG5hdi5hZGRDbGFzcygnbW9iaWxlJylcblx0XHRlbHNlIG5hdi5yZW1vdmVDbGFzcygnbW9iaWxlJylcbn1cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncmVhZHlzdGF0ZWNoYW5nZScsIGZ1bmN0aW9uKGVsKSB7XG5cdGlmICggZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2ludGVyYWN0aXZlJyApIHt9XG59KTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oKSB7XG5cblx0JCgnI2RvbS1wcmVsb2FkZXInKS5mYWRlT3V0KDUwMCwgZnVuY3Rpb24oKSB7XG5cdFx0Ly8kKCcjZG9tLXByZWxvYWRlcicpLnJlbW92ZSgpO1xuXHR9KTtcblx0JCgnYm9keScpLmZhZGVJbig1MDApO1xuXHR2YXIgb3ZlcmxheSA9ICQoJyNvdmVybGF5Jyk7XG5cdHZhciBuYXZpZ2F0aW9uID0gJCgnI2hlYWRlci1uYXYnKTtcblx0Y2hlY2tNb2JpbGVOYXZnYXRpb24obmF2aWdhdGlvbik7XG5cdG5hdmlnYXRpb24uY3NzKCdvcGFjaXR5JywgMSk7XG5cdHZhciBidXJnZXIgPSAkKCcjbmF2LWJ1cmdlcicpO1xuXHR2YXIgbW9iaWxlTWVudSA9ICQoJ3VsLnByaW1hcnktbWVudScpO1xuXHR2YXIgbWFpbmhlYWRlciA9ICQoJyNtYWluLWhlYWRlcicpO1xuXHRpZiAobWFpbmhlYWRlcikgbWFpbmhlYWRlci5hZGRDbGFzcygndmlzaWJsZScpO1xuXHR2YXIgc2Nyb2xsdXAgPSAkKCcjc2Nyb2xsLXVwJyk7XG5cdHZhciBzZWFyY2ggPSAkKCcjc2l0ZS1zZWFyY2gtbW9kYWwnKTtcblx0dmFyIGJhY2sydG9wID0gJCgnI2xpbmstdG8tdG9wJyk7XG5cdHZhciBnb3RvQmFjayA9ICQoJyNsaW5rLXRvLWJhY2s6bm90KC5zaG93LWluLXRvcCknKTtcbi8qXG5cdHZhciBzdG9wU2Nyb2xsO1xuXHR2YXIgc2Nyb2xsUG9zX1k7XG5cblx0ZnVuY3Rpb24gZGlzYWJsZVNjcm9sbCgpIHtcblx0XHRzY3JvbGxQb3NfWSA9ICQod2luZG93KS5zY3JvbGxUb3AoKTtcblx0XHRzdG9wU2Nyb2xsID0gdHJ1ZTtcblx0XHQkKCdib2R5JykuYWRkQ2xhc3MoJ3Njcm9sbC1kaXNhYmxlZCcpLmNzcygnbWFyZ2luLXRvcCcsIC1zY3JvbGxQb3NfWSArICdweCcpO1xuXG5cdFx0Ly8kKCcjb3ZlcmxheSAuaW1hZ2UtYm94Jykub24oXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oZSkgeyBlLnN0b3BQcm9wYWdhdGlvbigpOyB9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGVuYWJsZVNjcm9sbCgpIHtcblx0XHRzdG9wU2Nyb2xsID0gZmFsc2U7XG5cdFx0JCgnYm9keScpLnJlbW92ZUNsYXNzKCdzY3JvbGwtZGlzYWJsZWQnKS5jc3MoJ21hcmdpbi10b3AnLCAwKTtcblx0XHQkKHdpbmRvdykuc2Nyb2xsVG9wKHNjcm9sbFBvc19ZKTtcblxuXHRcdC8vJCgnI292ZXJsYXkgLmltYWdlLWJveCcpLnVuYmluZChcInRvdWNobW92ZVwiKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGRpc2FibGVUb3VjaE1vdmUoKSB7XG5cdFx0ZG9jdW1lbnQub250b3VjaG1vdmUgPSBmdW5jdGlvbihlKSB7IGUucHJldmVudERlZmF1bHQoKTsgfVxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0ZnVuY3Rpb24gZW5hYmxlVG91Y2hNb3ZlKCkge1xuXHRcdGRvY3VtZW50Lm9udG91Y2htb3ZlID0gZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG4qL1xuXHQvLyBpbiB2ZXdwb3J0IGNoZWNrIHNjcmlwdFxuXHRpblZpZXcub2Zmc2V0KDApO1xuXHRpblZpZXcoJ2gxJylcblx0XHQub24oJ2VudGVyJywgZWwgPT4ge1xuXHRcdFx0Ly9lbC5zdHlsZS5vcGFjaXR5ID0gMTtcblx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoJ2luLXZpZXcnKTtcblx0XHR9KVxuXHRcdC5vbignZXhpdCcsIGVsID0+IHtcblx0XHRcdC8vZWwuc3R5bGUub3BhY2l0eSA9IDAuNTtcblx0XHR9KTtcblx0aW5WaWV3KCdoMicpXG5cdFx0Lm9uKCdlbnRlcicsIGVsID0+IHtcblx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoJ2luLXZpZXcnKTtcblx0XHR9KTtcblx0aW5WaWV3KCcuZW50cnktY29udGVudCAud3AtYmxvY2stZ3JvdXBfX2lubmVyLWNvbnRhaW5lcicpXG5cdFx0Lm9uKCdlbnRlcicsIGVsID0+IHtcblx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoJ2luLXZpZXcnKTtcblx0XHR9KTtcblxuXG5cdCQoIHdpbmRvdyApLm9uKCAncmVzaXplJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0Y2hlY2tNb2JpbGVOYXZnYXRpb24obmF2aWdhdGlvbik7XG5cblx0XHRpZiAobW9iaWxlTWVudS5oYXNDbGFzcygnYWN0aXZlJykpIGJ1cmdlci5jbGljaygpOyAvLyBpZiBidXJnZXIgbWVudSBvcGVuIHRoZW4gY2xvc2UgaXRcblx0fSk7XG5cblx0JCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbigpIHtcblx0XHQvL2FkZFZpc2libGVDbGFzcyhkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoJ2FydGljbGUnKSk7IC8vdmlld3BvcnQuanNcblxuXHRcdGJhY2sydG9wICYmIGJhY2sydG9wLnRvcEJ0blRvZ2dsZSh7XG5cdFx0XHRzY3JvbGxUcmlnZ2VyOiAxMDAwLFxuXHRcdFx0Ly9kZWJ1ZzogdHJ1ZSxcblx0XHR9KTtcbi8qXG5cdFx0Z290b0JhY2sgJiYgZ290b0JhY2sudG9wQnRuVG9nZ2xlKHtcblx0XHRcdHNjcm9sbFRyaWdnZXI6IDEwMDAsXG5cdFx0XHQvL2RlYnVnOiB0cnVlLFxuXHRcdH0pO1xuXG5cdFx0aWYgKCAkKCdib2R5JykuaGFzKCcucGFyYWxsYXgnKS5sZW5ndGggKSB7XG5cdFx0XHQvLyBpbml0IHBhcmFsbGF4IGZvciBiYWNrZ3JvdW5kXG5cdFx0XHQkKCcucGFyYWxsYXgnKS5iZ1BhcmFsbGF4KHtcblx0XHRcdFx0Ymdwb3NpdGlvblk6IDUwLCAvL2l0IG11c3QgYmUgdGhlIHNhbWUgYmFja2dyb3VuZC1wb3NpdGlvbiB2YWx1ZSBpbiBjc3Ncblx0XHRcdFx0c3BlZWQ6IDAuNSxcblx0XHRcdH0pO1xuXHRcdH0qL1xuXHR9KTtcblxuXG4vKlxuLy8gQ2xpY2sgZXZlbnQgb24gbGluayBzdGFydGluZyBmcm9tICMgZm9yIGxhbmRpbmcgcGFnZVxuXHQkKCdhW2hyZWZePVwiI1wiXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZhciB0YXJnZXQgPSAkKHRoaXMpLmF0dHIoJ2hyZWYnKTtcblx0XHRpZiAoIHRhcmdldC5sZW5ndGggPiAxICYmIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PSAnLycgJiYgd2luZG93LmxvY2F0aW9uLnNlYXJjaCA9PSAnJykgeyAvL2lmIGhvbWUgcGFnZSBhbmQgbm8gc2VhcmNoIHF1ZXJ5IGFuZCBubyBvbmx5ICNcblx0XHRcdC8vaWYgKCQodGFyZ2V0KS5oYXNDbGFzcygnYW5pbWF0ZScpKSAkKHRhcmdldCkucmVtb3ZlQ2xhc3MoJ2FuaW1hdGUnKTtcblx0XHRcdGlmIChidXJnZXIuaXMoJzp2aXNpYmxlJykpIGJ1cmdlci5jbGljaygpOyAvL2Nsb3NlIGJ1cmdlciBtZW51IG9uIGxpbmsgY2xpY2tpbmdcblxuXHRcdFx0dmFyIHRvcCA9ICQodGFyZ2V0KS5vZmZzZXQoKS50b3A7XG5cdFx0XHQkKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7c2Nyb2xsVG9wOiB0b3B9LCA1MDArdG9wLzQpOyAvLzgwMCAtINC00LvQuNGC0LXQu9GM0L3QvtGB0YLRjCDRgdC60YDQvtC70LvQuNC90LPQsCDQsiDQvNGBXG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vdGFyZ2V0ID0gdGFyZ2V0LnJlcGxhY2UoL1teQS1aYS16XS9nLCBcIlwiKTtcblx0XHRcdGxvY2F0aW9uLnJlcGxhY2UoJy8nK3RhcmdldCk7XG5cdFx0fVxuXHR9KTtcblxuKi9cbi8qXG5cdGJ1cmdlci5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuXHRcdGlmIChidXJnZXIuaXMoJzp2aXNpYmxlJykpIHtcblx0XHRcdGJ1cmdlci50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHQkKCcjbWVudS10b3AnKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHQkKGRvY3VtZW50LmJvZHkpLnRvZ2dsZUNsYXNzKCdtb2RhbCcpO1xuXHRcdH1cblx0fSk7XG4qL1xuXG5cdC8vTmV3IHZlcnNpb24gd2l0aCBvd24gY2xvc2UgYnV0dG9uIGluIG1lbnVcblx0YnVyZ2VyLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0aWYgKCFtb2JpbGVNZW51Lmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuXHRcdFx0bW9iaWxlTWVudS5wcmVwZW5kKCc8ZGl2IGNsYXNzPVwiY2xvc2UtaWNvblwiPjwvZGl2PicpO1xuXHRcdFx0Ly9idXJnZXIudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0bW9iaWxlTWVudS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHQvLyQoZG9jdW1lbnQuYm9keSkudG9nZ2xlQ2xhc3MoJ21vZGFsJyk7XG5cdFx0fVxuXHR9KTtcblxuXHRtb2JpbGVNZW51Lm9uKCdjbGljaycsJy5jbG9zZS1pY29uJywgZnVuY3Rpb24gKGUpIHtcblx0XHRtb2JpbGVNZW51LnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5jaGlsZHJlbigpLnJlbW92ZSgnLmNsb3NlLWljb24nKTtcblx0fSk7XG4vKlxuXHR2YXIgc3VibWVudV9pdGVtID0gJCgnLm1lbnUtaXRlbS1oYXMtY2hpbGRyZW4gYScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdCQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xuXHR9KTtcbiovXG5cdCQoIGRvY3VtZW50ICkub24oICdrZXl1cCcsIGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGlmKCBlLmtleUNvZGUgPT0gMjcgJiYgc2VhcmNoLmlzKCc6dmlzaWJsZScpIClcblx0XHRcdHNlYXJjaC5mYWRlVG9nZ2xlKDMwMCkgLy9jbG9zZSBzZWFyY2ggZm9ybVxuXHRcdGVsc2Vcblx0XHRpZiggZS5rZXlDb2RlID09IDI3ICYmICFvdmVybGF5Lmhhc0NsYXNzKCdoaWRkZW4nKSApXG5cdFx0XHRvdmVybGF5LmNsaWNrKCkgLy9jbG9zZSBvdmVybGF5IGZvcm1cblx0XHRlbHNlIC8vY2xvc2UgYnVyZ2VyIG1lbnUgb24gZXNjIGtleVxuXHRcdGlmKCBlLmtleUNvZGUgPT0gMjcgJiYgbW9iaWxlTWVudS5oYXNDbGFzcygnYWN0aXZlJykgKSBtb2JpbGVNZW51LmNoaWxkcmVuKCcuY2xvc2UtaWNvbicpLmNsaWNrKCk7IC8vIGlmKCBlLmtleUNvZGUgPT0gMjcgJiYgYnVyZ2VyLmhhc0NsYXNzKCdhY3RpdmUnKSApIGJ1cmdlci5jbGljaygpO1xuXHR9KTtcblxuLypcblx0c2Nyb2xsdXAub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgbWMgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyNtYWluLWNvbnRhaW5lcicpO1xuXHRcdHNjcm9sbHVwXG5cdFx0LmZhZGVPdXQoJ3Nsb3cnKVxuXHRcdC5kZWxheSg1MDApXG5cdFx0LnJlbW92ZSgpXG5cdFx0LmRlbGF5KDUwMClcblx0XHQucXVldWUoIGZ1bmN0aW9uKCkge1xuXHRcdFx0bWMuc2Nyb2xsSW50b1ZpZXcoe2Jsb2NrOiBcInN0YXJ0XCIsIGJlaGF2aW9yOiBcInNtb290aFwifSk7XG5cdFx0fSk7XG5cdH0pO1xuKi9cblx0YmFjazJ0b3Aub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHQvLyA4MDAgLSDRgdC60L7RgNC+0YHRgtGMINC30LDQtNC10YDQttC60Lgg0L/QtdGA0LXQvNC10YnQtdC90LjRjyDQvdCw0LLQtdGA0YUgKNCyINC80LjQu9C70LjRgdC10LrRg9C90LTQsNGFKVxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHQkKCdodG1sLGJvZHknKS5hbmltYXRlKHtzY3JvbGxUb3A6IDB9LCA4MDApO1xuXHR9KTtcblxuXHQkKCcjbmF2LXNlYXJjaCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0aWYgKCAhc2VhcmNoLmF0dHIoJ2Rpc3BsYXknLCdub25lJykgJiYgc2VhcmNoLmZpbmQoJyNzJykudmFsKCkgKSB7XG5cdFx0XHQkKCcjc2VhcmNoZm9ybScpLnN1Ym1pdCgpO1xuXHRcdH0gZWxzZSBzZWFyY2guZmFkZVRvZ2dsZSgzMDApO1xuXHR9KTtcblxuXHQkKCcjc2VhcmNoLWNsb3NlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgZmllbGRfcyA9IHNlYXJjaC5maW5kKCcjcycpO1xuXHRcdGlmICggZmllbGRfcy52YWwoKSApIGZpZWxkX3MudmFsKCcnKVxuXHRcdGVsc2Ugc2VhcmNoLmZhZGVUb2dnbGUoMzAwKTtcblx0fSk7XG5cblx0b3ZlcmxheS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuXHRcdCQodGhpcykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXHRcdGVuYWJsZVNjcm9sbCgpO1xuXHR9KTtcbi8qXG5cdGlmICggJCgnLmpjYXJvdXNlbCcpLmhhcygnbGkuc2xpZGUnKS5sZW5ndGggKSB7XG5cblx0XHQkKCdbZGF0YS1qY2Fyb3VzZWxdJykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBlbCA9ICQodGhpcyk7XG5cdFx0XHRlbC5qY2Fyb3VzZWwoZWwuZGF0YSgpKTtcblx0XHR9KTtcblxuXHRcdHZhciB4U3RhcnQsIHlTdGFydDtcblx0XHR2YXIgc3RvcFRvdWNoO1xuXHRcdHZhciBzbGlkZXNQZXJQYWdlID0gMTtcblxuXHRcdHZhciBjYXJvdXNlbCA9ICQoJy5qY2Fyb3VzZWwnKTtcblx0XHRjYXJvdXNlbFxuXHRcdFx0Lm9uKCdqY2Fyb3VzZWw6Y3JlYXRlIGpjYXJvdXNlbDpyZWxvYWQnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGNhcm91c2VsX3cgPSBjYXJvdXNlbC5wYXJlbnQoKS5pbm5lcldpZHRoKCksXG5cdFx0XHRcdFx0Y2Fyb3VzZWxfaCA9IGNhcm91c2VsLnBhcmVudCgpLmlubmVySGVpZ2h0KCk7XG5cblx0XHRcdFx0c2xpZGVzUGVyUGFnZSA9IChjYXJvdXNlbF93ID4gY2Fyb3VzZWxfaCkgPyBNYXRoLnRydW5jKCAgY2Fyb3VzZWxfdyAvIGNhcm91c2VsX2ggKSA6IDE7XG5cblx0XHRcdFx0dmFyIHNsaWRlX3dpZHRoID0gTWF0aC5jZWlsKCBjYXJvdXNlbF93IC8gc2xpZGVzUGVyUGFnZSApO1xuXHRcdFx0XHRjYXJvdXNlbC5qY2Fyb3VzZWwoJ2l0ZW1zJykuY3NzKFwid2lkdGhcIiwgc2xpZGVfd2lkdGggKyAncHgnKTtcblx0XHRcdH0pXG5cdFx0XHQub24oJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdHhTdGFydCA9IGUudG91Y2hlc1swXS5zY3JlZW5YO1xuXHRcdFx0XHR5U3RhcnQgPSBlLnRvdWNoZXNbMF0uc2NyZWVuWTtcblx0XHRcdFx0c3RvcFRvdWNoID0gbnVsbDtcblx0XHRcdH0pXG5cdFx0XHQub24oJ3RvdWNobW92ZScsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0dmFyIHhNb3ZlbWVudCA9IE1hdGguYWJzKGUudG91Y2hlc1swXS5zY3JlZW5YIC0geFN0YXJ0KTtcblx0XHRcdFx0dmFyIHlNb3ZlbWVudCA9IE1hdGguYWJzKGUudG91Y2hlc1swXS5zY3JlZW5ZIC0geVN0YXJ0KTtcblx0XHRcdFx0aWYgKHN0b3BUb3VjaCA9PSBudWxsICYmICh4TW92ZW1lbnQgPiAxMCB8fCB5TW92ZW1lbnQgPiAxMCkpXG5cdFx0XHRcdFx0c3RvcFRvdWNoID0gKHlNb3ZlbWVudCA8IHhNb3ZlbWVudCkgPyBkaXNhYmxlVG91Y2hNb3ZlKCkgOiBlbmFibGVUb3VjaE1vdmUoKTtcblx0XHRcdH0pXG5cdFx0XHQub24oJ3RvdWNoZW5kIHRvdWNoY2FuY2VsJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHN0b3BUb3VjaCAmJiBlbmFibGVUb3VjaE1vdmUoKTtcblx0XHRcdH0pXG5cdFx0XHQub24oJ2pjYXJvdXNlbDpjcmVhdGVlbmQgamNhcm91c2VsOmFuaW1hdGVlbmQnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0JCh0aGlzKS5qY2Fyb3VzZWwoJ3RhcmdldCcpLmFkZENsYXNzKCdhY3RpdmUnKTtcblx0XHRcdH0pXG5cdFx0XHQub24oJ2pjYXJvdXNlbDp2aXNpYmxlb3V0JywgJ2xpJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFx0fSlcblx0XHRcdC5vbignY2xpY2snLCAnbGknLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHR2YXIgc3JjID0gJCh0aGlzKS5hdHRyKCdzcmMtdXJsJyk7XG5cdFx0XHRcdGlmIChzcmMpIHtcblx0XHRcdFx0XHRzcmMgPSAndXJsKCcrc3JjKycpJztcblx0XHRcdFx0XHQvL3ZhciBiZyA9ICQoZS50YXJnZXQpLmNzcygnYmFja2dyb3VuZC1pbWFnZScpO1xuXHRcdFx0XHRcdC8vYmcgPSBiZy5yZXBsYWNlKCd1cmwoJywnJykucmVwbGFjZSgnKScsJycpLnJlcGxhY2UoL1xcXCIvZ2ksIFwiXCIpO1xuXHRcdFx0XHRcdCFvdmVybGF5LmNoaWxkcmVuKCcuaW1hZ2Vib3gnKS5sZW5ndGggJiYgb3ZlcmxheS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJpbWFnZWJveFwiPjwvZGl2PjxkaXYgY2xhc3M9XCJjbG9zZSBjbG9zZS1pY29uXCIgdGl0bGU9XCJDbG9zZVwiPjwvZGl2PicpO1xuXHRcdFx0XHRcdG92ZXJsYXkuY2hpbGRyZW4oJy5pbWFnZWJveCcpLmNzcygnYmFja2dyb3VuZC1pbWFnZScsIHNyYykucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXHRcdFx0XHRcdGRpc2FibGVTY3JvbGwoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHRcdC5qY2Fyb3VzZWwoe1xuXHRcdFx0XHQvL3Njcm9sbDogc2xpZGVzUGVyUGFnZSxcblx0XHRcdFx0Ly9jZW50ZXI6IHRydWUsXG5cdFx0XHRcdHdyYXA6ICdjaXJjdWxhcicsXG5cdFx0XHRcdGFuaW1hdGlvbjogNTAwLFxuXHRcdFx0XHQvL3RyYW5zaXRpb25zOiB0cnVlLFxuXHRcdFx0XHR0cmFuc2l0aW9uczogTW9kZXJuaXpyLmNzc3RyYW5zaXRpb25zID8ge1xuXHRcdFx0XHRcdHRyYW5zZm9ybXM6ICAgTW9kZXJuaXpyLmNzc3RyYW5zZm9ybXMsXG5cdFx0XHRcdFx0dHJhbnNmb3JtczNkOiBNb2Rlcm5penIuY3NzdHJhbnNmb3JtczNkLFxuXHRcdFx0XHRcdGVhc2luZzogICAgICAgJ2Vhc2UnXG5cdFx0XHRcdH0gOiBmYWxzZVxuXHRcdFx0fSlcblx0XHRcdC8vLmpjYXJvdXNlbCgnc2Nyb2xsJywgJys9JytTdHJpbmcoc2xpZGVzUGVyUGFnZSkpXG5cdFx0XHQuamNhcm91c2VsU3dpcGUoe1xuXHRcdFx0XHQvL3BlclN3aXBlOiBzbGlkZXNQZXJQYWdlXG5cdFx0XHRcdC8vbWV0aG9kOiAnc2Nyb2xsSW50b1ZpZXcnIC8vIGJ5IGRlZmF1bHQgJ3Njcm9sbCdcblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAoICd0cnVlJyA9PT0gY2Fyb3VzZWwuYXR0cignZGF0YS1qY2Fyb3VzZWxhdXRvc2Nyb2xsJykgKSB7XG5cdFx0XHRcdGNhcm91c2VsLmpjYXJvdXNlbEF1dG9zY3JvbGwoe1xuXHRcdFx0XHRcdGludGVydmFsOiAgNTAwMCxcblx0XHRcdFx0XHQvL2F1dG9zdGFydDogZmFsc2UsXG5cdFx0XHRcdFx0Ly90YXJnZXQ6ICctPTEnK1N0cmluZyhzbGlkZXNQZXJQYWdlKVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCAkKCcuamNhcm91c2VsLXdyYXBwZXInKS5oYXMoJy5qY2Fyb3VzZWwtY29udHJvbCcpLmxlbmd0aCApIHtcblxuXHRcdFx0XHQkKCcuamNhcm91c2VsLWNvbnRyb2wucHJldicpXG5cdFx0XHRcdFx0Lm9uKCdqY2Fyb3VzZWxjb250cm9sOmFjdGl2ZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0JCh0aGlzKS5yZW1vdmVDbGFzcygnaW5hY3RpdmUnKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdC5vbignamNhcm91c2VsY29udHJvbDppbmFjdGl2ZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygnaW5hY3RpdmUnKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdC5qY2Fyb3VzZWxDb250cm9sKHtcblx0XHRcdFx0XHRcdC8vdGFyZ2V0OiAnLT0nK1N0cmluZyhzbGlkZXNQZXJQYWdlKVxuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdCQoJy5qY2Fyb3VzZWwtY29udHJvbC5uZXh0Jylcblx0XHRcdFx0XHQub24oJ2pjYXJvdXNlbGNvbnRyb2w6YWN0aXZlJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKCdpbmFjdGl2ZScpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0Lm9uKCdqY2Fyb3VzZWxjb250cm9sOmluYWN0aXZlJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQkKHRoaXMpLmFkZENsYXNzKCdpbmFjdGl2ZScpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0LmpjYXJvdXNlbENvbnRyb2woe1xuXHRcdFx0XHRcdFx0Ly90YXJnZXQ6ICcrPScrU3RyaW5nKHNsaWRlc1BlclBhZ2UpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRpZiAoICQoJy5qY2Fyb3VzZWwtd3JhcHBlcicpLmhhcygnLmpjYXJvdXNlbC1wYWdpbmF0aW9uJykubGVuZ3RoICYmICd0cnVlJyA9PT0gJCgnLmpjYXJvdXNlbC1wYWdpbmF0aW9uJykuYXR0cignZGF0YS1qY2Fyb3VzZWxwYWdpbmF0aW9uJykgKSB7XG5cdFx0XHQkKCcuamNhcm91c2VsLXBhZ2luYXRpb24nKVxuXHRcdFx0XHQub24oJ2pjYXJvdXNlbHBhZ2luYXRpb246YWN0aXZlJywgJ2EnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHQkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcblx0XHRcdFx0fSlcblx0XHRcdFx0Lm9uKCdqY2Fyb3VzZWxwYWdpbmF0aW9uOmluYWN0aXZlJywgJ2EnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0XHRcdFx0fSlcblx0XHRcdFx0LmpjYXJvdXNlbFBhZ2luYXRpb24oe1xuXHRcdFx0XHRcdC8vJ3BlclBhZ2UnOiBzbGlkZXNQZXJQYWdlXG5cdFx0XHRcdH0pO1xuXHRcdH0gZWxzZSAkKCcuamNhcm91c2VsLXBhZ2luYXRpb24nKS5yZW1vdmUoKTtcblxuXHR9XG4qL1xuXG4vKlxuXHQvL0FkZGluZyBhbiBhZ2VudCB0byBIVE1MIHNlbGVjdG9yXG5cdHZhciBkZXZpY2VBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcblx0aWYgKGRldmljZUFnZW50Lm1hdGNoKC8oaXBob25lfGlwb2R8aXBhZCkvKSkge1xuXHRcdCQoXCJodG1sXCIpLmFkZENsYXNzKFwibW9iaWxlXCIpO1xuXHRcdCQoXCJodG1sXCIpLmFkZENsYXNzKFwiaW9zXCIpO1xuXHR9XG5cdGlmIChuYXZpZ2F0b3IudXNlckFnZW50LnNlYXJjaChcIk1TSUVcIikgPj0gMCkge1xuXHRcdCQoXCJodG1sXCIpLmFkZENsYXNzKFwiaWVcIik7XG5cdH1cblx0ZWxzZSBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goXCJDaHJvbWVcIikgPj0gMCkge1xuXHRcdCQoXCJodG1sXCIpLmFkZENsYXNzKFwiY2hyb21lXCIpO1xuXHR9XG5cdGVsc2UgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKFwiRmlyZWZveFwiKSA+PSAwKSB7XG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJmaXJlZm94XCIpO1xuXHR9XG5cdGVsc2UgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKFwiU2FmYXJpXCIpID49IDAgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goXCJDaHJvbWVcIikgPCAwKSB7XG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJzYWZhcmlcIik7XG5cdH1cblx0ZWxzZSBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goXCJPcGVyYVwiKSA+PSAwKSB7XG5cdFx0JChcImh0bWxcIikuYWRkQ2xhc3MoXCJvcGVyYVwiKTtcblx0fVxuKi9cbn0pO1xuIl19
